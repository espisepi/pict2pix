var pict2pix;(()=>{"use strict";var t={d:(i,e)=>{for(var s in e)t.o(e,s)&&!t.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:e[s]})},o:(t,i)=>Object.prototype.hasOwnProperty.call(t,i),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},i={};t.r(i),t.d(i,{animate:()=>c,stop:()=>r});class e extends class{config;constructor(t){this.config=t}update(t){}draw(t){}}{constructor(t){super(t),this.x=Math.random()*this.config.maxWidth,this.y=Math.random()*this.config.maxHeight,this.speed=0,this.size=2*Math.random()+.2,this.color}update(t){this.y+=(3-this.speed)*t*.03*this.config.verticalSpeed,this.x+=(3-this.speed)*t*.03*this.config.horizontalSpeed,this.y>=this.config.maxHeight&&this.config.verticalSpeed>0&&(this.y=0,this.x=Math.random()*this.config.maxWidth),this.y<0&&this.config.verticalSpeed<0&&(this.y=this.config.maxHeight-1,this.x=Math.random()*this.config.maxWidth),this.x>=this.config.maxWidth&&this.config.horizontalSpeed>0&&(this.x=0,this.y=Math.random()*this.config.maxHeight),this.x<0&&this.config.horizontalSpeed<0&&(this.x=this.config.maxWidth-1,this.y=Math.random()*this.config.maxHeight);let i=Math.floor(this.y),e=Math.floor(this.x);i>=0&&i<this.config.maxHeight&&e>=0&&e<this.config.maxWidth&&(this.speed=this.config.mappedImage[i][e][0],this.color=this.config.mappedImage[i][e][1])}draw(t){t.beginPath(),t.globalAlpha=1,t.fillStyle=this.color,t.strokeStyle=this.color,t.arc(this.x,this.y,this.size,0,2*Math.PI),t.fill()}}class s extends e{#angle=0;constructor(t){super(t)}update(t){super.update(t),this.#angle+=this.speed/20,this.y+=Math.sin(this.#angle),this.x+=Math.cos(this.#angle)}}class a{#particles;constructor(){this.#particles={"straight-particle":t=>new e(t),"twisted-particle":t=>new s(t)}}createParticle(t){return this.#particles[t.particleType]?.(t)??new e}}class h{#canvas;#ctx;#reqAnim;#lastTime=0;#deltaTime=0;#particlesArray=[];#config;running=!1;constructor(t){this.#config=t,this.#canvas=document.createElement("canvas"),this.#canvas.width=this.#config.image.width||this.#config.image.naturalWidth,this.#canvas.height=this.#config.image.height||this.#config.image.naturalHeight,this.#ctx=this.#canvas.getContext("2d"),this.#ctx.drawImage(this.#config.image,0,0,this.#canvas.width,this.#canvas.height);const i=this.#ctx.getImageData(0,0,this.#canvas.width,this.#canvas.height);this.#ctx.clearRect(0,0,this.#canvas.width,this.#canvas.height),this.#config.numberOfParticles=this.#config.numberOfParticles||3e3,this.#config.mappedImage=this.mapImage(i),this.#config.maxWidth=this.#canvas.width,this.#config.maxHeight=this.#canvas.height,this.#config.verticalSpeed=t.verticalSpeed??1,this.#config.horizontalSpeed=t.horizontalSpeed??1;const e=new a;for(let i=0;i<this.#config.numberOfParticles;i++)this.#particlesArray.push(e.createParticle(t))}mapImage(t){let i=[];for(let e=0;e<this.#canvas.height;e++){let s=[];for(let i=0;i<this.#canvas.width;i++){const a=t.data[4*e*t.width+4*i],h=t.data[4*e*t.width+(4*i+1)],n=t.data[4*e*t.width+(4*i+2)],c=[this.calculateRelativeBrightness(a,h,n),"rgb("+a+","+h+","+n+")"];s.push(c)}i.push(s)}return i}calculateRelativeBrightness(t,i,e){return Math.sqrt(t*t*.299+i*i*.587+e*e*.114)/100}update(t){for(let i=0;i<this.#particlesArray.length;i++)this.#particlesArray[i].update(t)}draw(){this.#ctx.globalAlpha=.01,this.#ctx.fillStyle="rgb(0, 0, 0)",this.#ctx.fillRect(0,0,this.#canvas.width,this.#canvas.height);for(let t=0;t<this.#particlesArray.length;t++)this.#particlesArray[t].draw(this.#ctx)}start(){this.running||(this.#lastTime=0,this.#config.image.style.display="none",this.#config.image.parentNode.insertBefore(this.#canvas,this.#config.image),this.#reqAnim=requestAnimationFrame(this.loop.bind(this)),this.running=!0)}stop(){this.running&&(this.#config.image.style.display="initial",this.#config.image.parentNode.removeChild(this.#canvas),window.cancelAnimationFrame(this.#reqAnim),this.running=!1)}loop(t){this.#lastTime||(this.#lastTime=t),this.#deltaTime=t-this.#lastTime,this.#lastTime=t,this.update(this.#deltaTime),this.draw(),this.#reqAnim=requestAnimationFrame(this.loop.bind(this))}}var n={};function c(t){n[t.image.id]||(n[t.image.id]={pict2pix:new h(t),running:!0}),n[t.image.id].running=!0,n[t.image.id].pict2pix.start()}function r(t){n[t].running=!1,n[t].pict2pix.stop()}document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState?function(){for(var t in n)n[t].running&&n[t].pict2pix.stop()}():function(){for(var t in n)n[t].running&&n[t].pict2pix.start()}()}),!1),pict2pix=i})();